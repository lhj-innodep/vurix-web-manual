<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VURIX Mobile 웹 매뉴얼</title>
  <style>
    :root{
      --header1-h:56px;      /* 타이틀 바 높이 */
      --header2-h:48px;      /* 메뉴 바 기본 높이 */
      --header2-computed:48px; /* 실제 측정 높이 (JS가 갱신) */
      --footer-h:40px;       /* 푸터 높이 */
      --gap-cf:10px;         /* 콘텐츠와 푸터 사이 여백 */
      --bar-bg:#f6f6f6;
      --border:#d0d7de;
      --active:#0969da;
    }
    *{box-sizing:border-box}
    html{font-size:100%;}
    html,body{height:100%;margin:0;color:#222;background:#fff;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Malgun Gothic","맑은 고딕",Arial,sans-serif;
    }

    /* 상단 타이틀 바 */
    .top-title{
      position:fixed;top:0;left:0;right:0;height:var(--header1-h);
      background:var(--bar-bg);display:flex;align-items:center;
      padding:0 16px;border-bottom:none;z-index:1000;
    }
    .title-txt{font-size:1.125rem;font-weight:700;}

    /* 상단 메뉴 바 (깃허브 톤) */
    .top-menu{
      position:fixed;top:var(--header1-h);left:0;right:0;
      height:auto;background:var(--bar-bg);z-index:999;
      border-bottom:1px solid var(--border);
      display:flex;align-items:flex-end;justify-content:flex-start;
      overflow:hidden;
    }
    .menu-list{
      width:100%;display:flex;flex-wrap:nowrap;gap:16px;
      padding:0 12px 0 12px;align-items:flex-end;justify-content:flex-start;
      height:var(--header2-h);
    }
    .menu-item{
      background:transparent;border:0;cursor:pointer;
      padding:0 10px 12px 10px;height:var(--header2-h);
      display:flex;align-items:flex-end;white-space:nowrap;
      font-size:0.9375rem;color:#24292f;border-radius:0;
    }
    .menu-item:hover{color:#111;}
    .menu-item.active{color:#111;font-weight:600;position:relative;}
    .menu-item.active::after{content:"";position:absolute;left:8px;right:8px;bottom:-1px;height:2px;background:var(--active);}

    /* 콘텐츠 영역 */
    .content-wrap{
      position:fixed;left:0;right:0;
      top:calc(var(--header1-h) + var(--header2-computed));
      bottom:calc(var(--footer-h) + var(--gap-cf));
      padding-left:5px;padding-right:5px;background:#fff;
    }
    .content-inner{position:relative;width:100%;height:100%;}
    iframe#contentFrame{width:100%;height:100%;border:none;background:#fff;display:block;}

    /* 푸터 */
    .footer{
      position:fixed;left:0;right:0;bottom:0;height:var(--footer-h);
      background:#fff;border-top:none;display:flex;align-items:center;
      justify-content:flex-start;padding-left:5px;font-size:0.75rem;color:#666;z-index:1000;
    }

    /* 반응형: 모바일에서 메뉴 줄바꿈 */
    @media (max-width: 700px){
      .menu-list{flex-wrap:wrap;row-gap:6px;height:auto;padding:6px 12px;}
      .menu-item{height:38px;padding-bottom:6px;}
    }
  </style>
</head>
<body>
  <!-- 상단 두 줄 -->
  <header class="top-title" role="banner">
    <div class="title-txt">VURIX Mobile</div>
  </header>
  <nav class="top-menu" role="navigation" aria-label="주 메뉴">
    <div class="menu-list" id="menuList">
      <button class="menu-item" data-src="./start.html">시작</button>
      <button class="menu-item" data-src="./live.html">실시간 영상</button>
      <button class="menu-item" data-src="./recorded.html">녹화 영상</button>
      <button class="menu-item" data-src="./event.html">이벤트</button>
      <button class="menu-item" data-src="./setup.html">설정</button>
      <button class="menu-item" data-src="./other.html">기타</button>
      <button class="menu-item" data-src="./info.html">참고</button>
    </div>
  </nav>

  <!-- 중앙 콘텐츠 -->
  <main class="content-wrap" role="main">
    <div class="content-inner">
      <iframe id="contentFrame" title="콘텐츠 프레임" src="" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
  </main>

  <!-- 하단바 -->
  <footer class="footer" role="contentinfo">©2025 Innodep, Inc.</footer>

  <script>
    (function(){
      var iframe = document.getElementById('contentFrame');
      var menuButtons = Array.prototype.slice.call(document.querySelectorAll('.menu-item'));
      var menuList = document.getElementById('menuList');
      var topMenu = document.querySelector('.top-menu');
      var SCALE = 1.5;       // PC 확대 배율
      var DESKTOP_BP = 901;  // 데스크톱 적용 임계폭

      function setActive(btn){
        menuButtons.forEach(function(b){ b.classList.toggle('active', b===btn); });
      }

      function loadSrc(src, btn){
        if (!src) return;
        iframe.src = src;
        if (btn) setActive(btn);
        try { if (location.hash !== '#' + src) location.hash = '#' + src; } catch(e){}
      }

      function applyHeaderHeight(){
        try{
          var h = topMenu.getBoundingClientRect().height;
          document.documentElement.style.setProperty('--header2-computed', h + 'px');
        }catch(e){}
      }

      function isDesktop(){ return window.innerWidth >= DESKTOP_BP; }

      // 바깥 문서 스크롤 정책: 데스크톱에서는 바깥 숨김, iframe만 세로 스크롤
      function applyViewportMode(){
        var desk = isDesktop();
        document.documentElement.style.overflowY = desk ? 'hidden' : 'auto';
        document.body.style.overflowY = desk ? 'hidden' : 'auto';
        applyHeaderHeight();
      }

      // iframe 내부에 기본 스타일 주입
      function injectBaseStyles(doc){
        var head = doc.head || doc.getElementsByTagName('head')[0];
        if (!head) return;
        var base = doc.createElement('style');
        base.type = 'text/css';
        base.appendChild(doc.createTextNode([
          'html, body{margin:0;padding:0;}',
          'body{display:flow-root;}',
          'body>*:first-child{margin-top:0 !important;}',
          '._1-1-Heading:first-of-type{margin-top:0 !important;padding-top:0 !important;}',
          'img[src*="0_ICON"]{height:1em;width:auto;vertical-align:middle;}'
        ].join('\n')));
        head.appendChild(base);

        // 모바일 표 규칙
        var mo = doc.createElement('style');
        mo.type = 'text/css';
        mo.media = 'screen and (max-width: 700px)';
        mo.appendChild(doc.createTextNode([
          'table{ width:100% !important; table-layout:auto !important; }',
          'th,td{ white-space:normal !important; overflow-wrap:anywhere !important; word-break:break-word !important; }',
          'table img{ max-width:100% !important; height:auto !important; }'
        ].join('\n')));
        head.appendChild(mo);
      }

      // 데스크톱에서만 150% 확대: body 하위에 래퍼를 만들어 transform
      function applyDesktopScale(doc){
        if (!doc) return;
        var body = doc.body;
        if (!body) return;
        var head = doc.head || doc.getElementsByTagName('head')[0];

        // 이미 래퍼가 있으면 재사용
        var wrap = doc.getElementById('zoomRoot');
        var desk = isDesktop();

        if (desk){
          if (!wrap){
            wrap = doc.createElement('div');
            wrap.id = 'zoomRoot';
            // 기존 body 자식들을 래퍼로 이동
            while (body.firstChild){
              wrap.appendChild(body.firstChild);
            }
            body.appendChild(wrap);
          }
          // 스타일 적용: 가로폭 보정 + 확대
          wrap.style.transformOrigin = '0 0';
          // zoom 우선(Chromium), 파이어폭스 대응으로 transform 병행
          wrap.style.zoom = String(SCALE);
          wrap.style.transform = 'scale(' + SCALE + ')';
          wrap.style.width = 'calc(100% / ' + SCALE + ')';
          wrap.style.position = 'relative';

          // 파이어폭스에서 transform만 적용될 때 스크롤이 잘 되도록 body 폭을 자동으로
          body.style.width = '100%';
        }else{
          // 모바일/태블릿에서는 래퍼 해제(원복) — 중복 확대 방지
          if (wrap){
            while (wrap.firstChild){
              body.insertBefore(wrap.firstChild, wrap);
            }
            wrap.remove();
          }
          body.style.zoom = '';
        }
      }

      function onIframeLoad(){
        try{
          var doc = iframe.contentDocument || iframe.contentWindow.document;
          if (!doc) return;
          injectBaseStyles(doc);
          applyDesktopScale(doc);
        }catch(e){}
      }

      iframe.addEventListener('load', onIframeLoad);

      function syncFromHash(){
        var hash = location.hash || '#start.html';
        var src = hash.replace(/^#/, '');
        var targetBtn = null;
        for (var i=0;i<menuButtons.length;i++){
          if (menuButtons[i].dataset.src === src){ targetBtn = menuButtons[i]; break; }
        }
        if (targetBtn){ setActive(targetBtn); }
        iframe.src = src;
      }
      window.addEventListener('hashchange', syncFromHash);

      menuButtons.forEach(function(btn){
        btn.addEventListener('click', function(){ loadSrc(btn.dataset.src, btn); });
      });

      document.addEventListener('DOMContentLoaded', function(){
        applyViewportMode();
        syncFromHash();
      });

      window.addEventListener('resize', function(){
        applyViewportMode();
        try{
          var doc = iframe.contentDocument || iframe.contentWindow.document;
          applyDesktopScale(doc);
        }catch(e){}
      });

      if ('ResizeObserver' in window){
        var ro = new ResizeObserver(function(){ applyHeaderHeight(); });
        ro.observe(menuList);
      }
    })();
  </script>
</body>
</html>
