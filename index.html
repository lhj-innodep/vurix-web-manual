<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>VURIX Mobile 웹 매뉴얼</title>
  <style>
    :root{
      --header1-h:56px;
      --header2-h:48px;           /* 기본 메뉴 높이(실제 높이로 스크립트가 덮어씀) */
      --header2-computed:48px;    /* 실측 메뉴 높이 */
      --footer-h:40px;
      --bar-bg:#f6f6f6;
      --gh-border:#d0d7de;
      --gh-active:#0969da;
      --gap-cf:14px;              /* 콘텐츠-푸터 사이 간격 */
      --scale:1.5;                /* PC 확대 배율 */
    }
    *{box-sizing:border-box}
    html,body{
      height:100%; margin:0; color:#222; background:#fff;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Malgun Gothic","맑은 고딕",Arial,sans-serif;
    }

    /* 상단 타이틀 바 */
    .top-title{
      position:fixed; top:0; left:0; right:0; height:var(--header1-h);
      background:var(--bar-bg); display:flex; align-items:center; gap:12px;
      padding:0 16px; border-bottom:none; z-index:1000;
    }
    .title-txt{font-size:18px; font-weight:700; color:#111; user-select:none;}
    .title-txt img[src*="0_ICON"]{height:1em; width:auto; vertical-align:middle;}

    /* 상단 메뉴 */
    .top-menu{
      position:fixed; top:var(--header1-h); left:0; right:0;
      height:auto; min-height:var(--header2-h);
      background:var(--bar-bg); display:flex; align-items:flex-end;
      border-bottom:1px solid var(--gh-border);
      z-index:999; overflow:hidden; /* 스크롤바 차단 */
    }
    .menu-inner{ width:900px; max-width:100%; margin:0; }
    .menu-list{
      display:flex; flex-wrap:nowrap; justify-content:flex-start; align-items:flex-end;
      gap:16px; padding:0 12px 0 12px; height:48px;
    }
    .menu-item{
      position:relative; background:transparent; border:0; cursor:pointer;
      padding:0 10px 10px 10px; display:flex; align-items:flex-end;
      font-size:15px; color:#24292f; white-space:nowrap;
    }
    .menu-item.active{ color:#111; font-weight:600; }
    .menu-item.active::after{ content:""; position:absolute; left:8px; right:8px; bottom:-1px; height:2px; background:var(--gh-active); }

    /* 콘텐츠 영역 */
    .content-wrap{
      position:fixed; left:0; right:0;
      top:calc(var(--header1-h) + var(--header2-computed));
      bottom:calc(var(--footer-h) + var(--gap-cf));
      padding-left:20px; background:#fff;
    }
    .content-inner{ position:relative; width:100%; height:100%; }
    iframe#contentFrame{ width:100%; height:100%; border:none; background:#fff; display:block; }

    /* 하단 고정바 */
    .footer{
      position:fixed; left:0; right:0; bottom:0; height:var(--footer-h);
      background:#fff; border-top:none; display:flex; align-items:center; justify-content:flex-start;
      padding-left:20px; font-size:12px; color:#666; z-index:1000;
    }

    /* 모바일(임계폭 700px)에서 메뉴 줄바꿈 */
    @media (max-width:700px){
      :root{ --header1-h:52px; --footer-h:40px; }
      .menu-list{ flex-wrap:wrap; row-gap:6px; height:auto; }
      .menu-item{ font-size:14px; padding:0 8px 10px 8px; }
      /* 모바일은 바깥 페이지 스크롤 허용 */
      html,body{ overflow:auto; }
    }

    /* 데스크톱에선 바깥 스크롤 숨기고 iframe만 스크롤 */
    @media (min-width:1024px){
      html,body{ overflow:hidden; }
    }
  </style>
</head>
<body>
  <!-- 상단 -->
  <header class="top-title"><span class="title-txt">VURIX Mobile</span></header>
  <nav class="top-menu" aria-label="주 메뉴">
    <div class="menu-inner">
      <div class="menu-list">
        <button class="menu-item" data-src="./start.html">시작</button>
        <button class="menu-item" data-src="./live.html">실시간 영상</button>
        <button class="menu-item" data-src="./recorded.html">녹화 영상</button>
        <button class="menu-item" data-src="./event.html">이벤트</button>
        <button class="menu-item" data-src="./setup.html">설정</button>
        <button class="menu-item" data-src="./other.html">기타</button>
        <button class="menu-item" data-src="./info.html">참고</button>
      </div>
    </div>
  </nav>

  <!-- 중앙 -->
  <main class="content-wrap">
    <div class="content-inner">
      <iframe id="contentFrame" title="콘텐츠 프레임" src="" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
  </main>

  <!-- 하단 -->
  <footer class="footer">©2025 Innodep, Inc.</footer>

  <script>
    (function(){
      const iframe = document.getElementById('contentFrame');
      const menuButtons = Array.from(document.querySelectorAll('.menu-item'));
      const menuList = document.querySelector('.menu-list');
      const topMenu = document.querySelector('.top-menu');

      // 메뉴 높이 실측 → content top 보정
      function measureMenu(){
        const h = topMenu.getBoundingClientRect().height;
        document.documentElement.style.setProperty('--header2-computed', h + 'px');
      }

      // 메뉴 클릭시 iframe 교체 + 해시 갱신
      function setActive(btn){ menuButtons.forEach(b => b.classList.toggle('active', b===btn)); }
      function loadSrc(src, btn){
        iframe.src = src;
        if (btn) setActive(btn);
        if (src) location.hash = src.replace('./','');
      }
      menuButtons.forEach(btn => btn.addEventListener('click', ()=> loadSrc(btn.dataset.src, btn)));

      // 해시 진입 처리
      function initFromHash(){
        const hash = (location.hash || '').replace('#','');
        const btn = menuButtons.find(b => b.dataset.src.includes(hash)) || menuButtons[0];
        if (btn) loadSrc(btn.dataset.src, btn);
      }

      // PC 150% 확대: 내부 문서에만 적용
      const isDesktop = () => window.matchMedia('(min-width:1024px)').matches;
      const isMobile700 = () => window.matchMedia('(max-width:700px)').matches;

      function injectStyles(doc){
        // 공통: 첫 제목 여백 제거 + 마진 접힘 방지 + 아이콘 1em
        const style = doc.createElement('style');
        style.textContent = `
          html, body { margin:0; padding:0; }
          body { display: flow-root !important; }
          body > *:first-child { margin-top:0 !important; }
          ._1-1-Heading:first-of-type { margin-top:0 !important; padding-top:0 !important; }
          img[src*="0_ICON"]{ height:1em !important; width:auto !important; vertical-align:middle; }
        `;
        doc.head && doc.head.appendChild(style);

        // PC에서만 내부 확대
        if (isDesktop()){
          const b = doc.body;
          if (b){
            b.style.zoom = '1.5';
            b.style.transformOrigin = 'top left';
            if (!('zoom' in b.style)){
              b.style.transform = 'scale(1.5)';
              b.style.width = 'calc(100% / 1.5)';
            }
          }
          // 폭이 줄어들며 축소되는걸 방지: 내부 최소폭 900px
          const htmlEl = doc.documentElement;
          if (htmlEl){
            htmlEl.style.minWidth = '900px';
          }
        }else{
          // 모바일에서는 확대 제거
          const b = doc.body;
          if (b){
            b.style.zoom = '';
            b.style.transform = '';
            b.style.width = '';
          }
        }

        // 모바일(<=700px)에서 표 100% + 줄바꿈
        if (isMobile700()){
          const style2 = doc.createElement('style');
          style2.textContent = `
            @media (max-width:700px){
              table{ width:100% !important; max-width:none !important; table-layout:auto !important; }
              th, td{
                white-space: normal !important;
                overflow-wrap: anywhere !important;
                word-break: break-word !important;
                text-overflow: clip !important;
                padding: 6px;
              }
              table img{ max-width:100% !important; height:auto !important; }
            }
          `;
          doc.head && doc.head.appendChild(style2);
        }
      }

      function onIframeLoad(){
        try{
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          if (!doc) return;
          injectStyles(doc);
        }catch(e){}
      }
      iframe.addEventListener('load', onIframeLoad);

      // 초기화
      document.addEventListener('DOMContentLoaded', ()=>{
        measureMenu();
        initFromHash();
      });
      window.addEventListener('resize', measureMenu);
      new ResizeObserver(measureMenu).observe(menuList);
    })();
  </script>
</body>
</html>
