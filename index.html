<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>VURIX Mobile 웹 매뉴얼</title>
  <style>
    :root {
      --header1-h: 56px;   /* 타이틀 바 높이 */
      --header2-h: 48px;   /* 메뉴 바 기본 높이(실제는 JS로 실측) */
      --header2-real: 48px;
      --footer-h: 40px;    /* 푸터 높이 */
      --bar-bg: #f6f6f6;   /* 상단 고정바 배경색 */
      --gap-cf: 10px;      /* 콘텐츠와 푸터 사이 여백 */
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      color: #222;
      background: #fff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", "맑은 고딕", Arial, sans-serif;
    }

    /* 상단 타이틀 바 */
    .top-title {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--header1-h);
      background: var(--bar-bg);
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 0 16px;
      border-bottom: none; /* 줄 제거 */
      z-index: 1000;
    }
    .title-text {
      font-size: 18px;
      font-weight: 700;
      color: #111;
      white-space: nowrap;
    }

    /* 상단 메뉴 바 (GitHub 스타일 탭, 좌측 정렬) */
    .top-menu {
      position: fixed;
      top: var(--header1-h); left: 0; right: 0;
      background: var(--bar-bg);
      height: var(--header2-real);
      display: flex;
      align-items: end;
      border-bottom: 1px solid #d0d7de;
      z-index: 999;
      overflow: hidden; /* 우측 스크롤바 차단 */
    }
    .menu-list {
      display: flex;
      flex-wrap: nowrap;
      justify-content: flex-start !important;
      align-items: end;
      gap: 16px;
      padding: 0 12px;
      height: 48px;
      margin: 0 !important;
    }
    .menu-item {
      position: relative;
      background: transparent;
      border: 0;
      cursor: pointer;
      height: 48px;
      padding: 0 10px 10px 10px;
      display: flex;
      align-items: end;
      font-size: 15px;
      color: #24292f;
      white-space: nowrap;
    }
    .menu-item:hover { color: #111; }
    .menu-item.active { color: #111; font-weight: 600; }
    .menu-item.active::after {
      content: ""; position: absolute; left: 8px; right: 8px; bottom: -1px; height: 2px;
      background: #0969da;
    }

    /* 중앙 콘텐츠 영역 */
    .content-wrap {
      position: fixed;
      top: calc(var(--header1-h) + var(--header2-real));
      left: 0; right: 0;
      bottom: calc(var(--footer-h) + var(--gap-cf));
      padding-left: 5px;
      padding-right: 5px;
      background: #fff;
    }
    .content-inner {
      width: 100%; height: 100%;
    }
    iframe#contentFrame {
      width: 100%;
      height: 100%;
      border: none;
      background: #fff;
      display: block;
    }

    /* 하단 고정 푸터 (좌측 정렬) */
    .footer {
      position: fixed;
      left: 0; right: 0; bottom: 0;
      height: var(--footer-h);
      background: #fff;  /* 콘텐츠와 동일 */
      border-top: none;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding-left: 20px;
      font-size: 12px;
      color: #666;
      z-index: 1000;
    }

    /* 모바일 임계폭 */
    @media (max-width: 700px) {
      :root { --header1-h: 52px; --header2-h: 48px; --footer-h: 40px; }
      .menu-list { flex-wrap: wrap; row-gap: 6px; height: auto; }
      .menu-item { height: 44px; font-size: 14px; padding: 0 8px 8px 8px; }
    }
  </style>
</head>
<body>
  <!-- 상단 두 줄 고정바 -->
  <header class="top-title" role="banner">
    <span class="title-text">VURIX Mobile</span>
  </header>
  <nav class="top-menu" role="navigation" aria-label="주 메뉴">
    <div class="menu-list" id="menuList">
      <button class="menu-item" data-src="./start.html">시작</button>
      <button class="menu-item" data-src="./live.html">실시간 영상</button>
      <button class="menu-item" data-src="./recorded.html">녹화 영상</button>
      <button class="menu-item" data-src="./event.html">이벤트</button>
      <button class="menu-item" data-src="./setup.html">설정</button>
      <button class="menu-item" data-src="./other.html">기타</button>
      <button class="menu-item" data-src="./info.html">참고</button>
    </div>
  </nav>

  <!-- 중앙 콘텐츠 -->
  <main class="content-wrap" role="main">
    <div class="content-inner">
      <iframe id="contentFrame" title="콘텐츠 프레임" src="" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
  </main>

  <!-- 하단바 -->
  <footer class="footer" role="contentinfo">©2025 Innodep, Inc.</footer>

  <script>
    (function(){
      const iframe = document.getElementById('contentFrame');
      const menuButtons = Array.from(document.querySelectorAll('.menu-item'));
      const menuList = document.getElementById('menuList');
      const topMenu = document.querySelector('.top-menu');

      // 해시 라우팅: #start.html 등
      function srcFromHash(){
        const h = (location.hash || '').replace(/^#/, '').trim();
        if (!h) return null;
        // 안전한 파일만 허용
        const allow = new Set(['start.html','live.html','recorded.html','event.html','setup.html','other.html','info.html','index.html']);
        if (allow.has(h)) return './' + h;
        return null;
      }

      function setActive(btn){
        menuButtons.forEach(b=>b.classList.toggle('active', b===btn));
      }

      function loadSrc(src, btn){
        iframe.src = src;
        if (btn) setActive(btn);
        // 해시 갱신
        const name = src.replace(/^\.\//,'').trim();
        if (name !== 'index.html') location.hash = name;
      }

      // 메뉴 클릭 처리
      menuButtons.forEach(btn => {
        btn.addEventListener('click', () => loadSrc(btn.dataset.src, btn));
      });

      // 초기 로드
      document.addEventListener('DOMContentLoaded', () => {
        // 상단 메뉴 실제 높이 반영
        applyTopMenuHeight();
        window.addEventListener('resize', applyTopMenuHeight);
        new ResizeObserver(applyTopMenuHeight).observe(menuList);

        const fromHash = srcFromHash();
        const defaultBtn = fromHash ? menuButtons.find(b => b.dataset.src === fromHash) : menuButtons.find(b => b.textContent.trim() === '시작');
        if (defaultBtn) {
          loadSrc(defaultBtn.dataset.src, defaultBtn);
        } else {
          loadSrc('./start.html', null);
        }
      });

      function applyTopMenuHeight(){
        const h = Math.max(topMenu.getBoundingClientRect().height, 48);
        document.documentElement.style.setProperty('--header2-real', h + 'px');
      }

      // ====== IFRAME 내부에 스타일/스クリプ트 주입 ======
      function injectCssForFonts(doc){
        // PC 전용: 701px 이상
        const isPc = window.matchMedia('(min-width: 701px)').matches;
        const style = doc.createElement('style');
        let css = '';
        if (isPc) {
          css += `
            /* 첫 대제목 상단 여백 줄이기 + 마진 접힘 방지 */
            body { display: flow-root !important; }
            body > *:first-child { margin-top: 0 !important; }
            ._1-1-Heading:first-of-type { margin-top: 0 !important; padding-top: 0 !important; }
            /* 인디자인 스타일 → HTML 폰트 크기 (요청 매핑, PC 전용) */
            [class~="01-1-Heading"]{ font-size:40px !important; }
            [class~="01-2-Heading"]{ font-size:35px !important; }
            [class~="01-3-Heading"]{ font-size:28px !important; }

            [class~="02-1-Basic-L"]{ font-size:25px !important; }
            [class~="02-2-Basic-L-Sub"]{ font-size:25px !important; }
            [class~="02-3-Basic-L-Center"]{ font-size:25px !important; text-align:center !important; }

            [class~="03-1-Num"]{ font-size:25px !important; }
            [class~="03-2-Num(2-9)"]{ font-size:25px !important; }
            [class~="03-3-Num(10)"]{ font-size:25px !important; }

            [class~="04-1-Bull-L"]{ font-size:25px !important; }
            [class~="04-2-Bull-L-Sub"]{ font-size:25px !important; }
            [class~="04-3-Bull-L-Sub(H)"]{ font-size:25px !important; }

            [class~="05-1-Bold"]{ font-size:25px !important; font-weight:700 !important; }
            [class~="05-2-Bold-Sub"]{ font-size:25px !important; }
            [class~="05-3-Bold-Center"]{ font-size:25px !important; text-align:center !important; }
            [class~="05-4-Bold-Bull"]{ font-size:25px !important; }

            [class~="06-1-Note-B"]{ font-size:25px !important; }
            [class~="06-2-Note-Bull-L"]{ font-size:25px !important; }
            [class~="06-3-Info-L"]{ font-size:25px !important; }

            [class~="07-1-Ring-B"]{ font-size:25px !important; }
            [class~="07-2-Ring-B-Sub"]{ font-size:25px !important; }

            [class~="08-1-Small-L"]{ font-size:23px !important; }
            [class~="08-2-Small-L-Sub"]{ font-size:23px !important; }
            [class~="08-3-Small-L-Center"]{ font-size:23px !important; text-align:center !important; }
            [class~="08-4-Small-B-Center"]{ font-size:23px !important; text-align:center !important; }
            [class~="08-5-Small-Bull-L"]{ font-size:23px !important; }
          `;
        }

        /* 모바일 전용: 표 100% 폭 + 줄바꿈, 아이콘 리사이즈 */
        css += `
          @media (max-width: 700px){
            table { width: 100% !important; table-layout: auto !important; }
            th, td { white-space: normal !important; overflow-wrap: anywhere !important; word-break: break-word !important; text-overflow: clip !important; padding: 6px; }
            table img { max-width: 100% !important; height: auto !important; }
          }
          /* 아이콘 파일명에 0_ICON 포함 시 글자 크기에 맞춤 */
          img[src*="0_ICON"] { height: 1em !important; width: auto !important; vertical-align: middle !important; }
        `;
        style.textContent = css;
        (doc.head || doc.documentElement).appendChild(style);
      }

      function fixFirstHeadingMargin(doc){
        try{
          // 첫 번째 _1-1-Heading 여백 제거 (인라인 보정)
          const firstH = doc.querySelector('._1-1-Heading');
          if (firstH) {
            firstH.style.setProperty('margin-top','0','important');
            firstH.style.setProperty('padding-top','0','important');
          }
          // 상단 첫 3 요소의 과도한 margin-top 제거
          let el = doc.body && doc.body.firstElementChild;
          let n = 0;
          while (el && n < 3) {
            const cs = doc.defaultView.getComputedStyle(el);
            const mt = parseFloat(cs.marginTop || '0');
            if (mt > 0) el.style.setProperty('margin-top','0','important');
            el = el.nextElementSibling; n++;
          }
        }catch(e){}
      }

      // iframe 로드 후 내부 보정
      function onIframeLoad(){
        try{
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          if (!doc) return;
          injectCssForFonts(doc);
          fixFirstHeadingMargin(doc);
        }catch(e){}
      }
      iframe.addEventListener('load', onIframeLoad);
    })();
  </script>
</body>
</html>
