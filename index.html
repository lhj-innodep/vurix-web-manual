<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VURIX Mobile 웹 매뉴얼</title>
  <style>
    :root{
      --header1-h:56px;      /* 타이틀 바 높이 */
      --header2-h:48px;      /* 메뉴 바 기본 높이 */
      --header2-computed:48px; /* 실제 측정 높이 (JS가 갱신) */
      --footer-h:40px;       /* 푸터 높이 */
      --gap-cf:10px;         /* 콘텐츠와 푸터 사이 여백 */
      --bar-bg:#f6f6f6;
      --border:#d0d7de;
      --active:#0969da;
      --bp-mobile:700px;     /* 모바일 임계폭 */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;color:#222;background:#fff;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Malgun Gothic","맑은 고딕",Arial,sans-serif;
    }

    /* 상단 타이틀 바 */
    .top-title{
      position:fixed;top:0;left:0;right:0;height:var(--header1-h);
      background:var(--bar-bg);display:flex;align-items:center;
      padding:0 16px;border-bottom:none;z-index:1000;
    }
    .title-txt{font-size:18px;font-weight:700;}

    /* 상단 메뉴 바 */
    .top-menu{
      position:fixed;top:var(--header1-h);left:0;right:0;
      height:auto;background:var(--bar-bg);z-index:999;
      border-bottom:1px solid var(--border);
      display:flex;align-items:flex-end;justify-content:flex-start;
      overflow:hidden;
    }
    .menu-list{
      width:100%;display:flex;flex-wrap:nowrap;gap:16px;
      padding:0 12px 0 12px;align-items:flex-end;justify-content:flex-start;
      height:var(--header2-h);
    }
    .menu-item{
      background:transparent;border:0;cursor:pointer;
      padding:0 10px 12px 10px;height:var(--header2-h);
      display:flex;align-items:flex-end;white-space:nowrap;
      font-size:15px;color:#24292f;border-radius:0;
    }
    .menu-item:hover{color:#111;}
    .menu-item.active{color:#111;font-weight:600;position:relative;}
    .menu-item.active::after{content:"";position:absolute;left:8px;right:8px;bottom:-1px;height:2px;background:var(--active);}

    /* 콘텐츠 영역 */
    .content-wrap{
      position:fixed;left:0;right:0;
      top:calc(var(--header1-h) + var(--header2-computed));
      bottom:calc(var(--footer-h) + var(--gap-cf));
      padding-left:5px;padding-right:5px;background:#fff;
    }
    .content-inner{position:relative;width:100%;height:100%;}
    iframe#contentFrame{width:100%;height:100%;border:none;background:#fff;display:block;}

    /* 푸터 */
    .footer{
      position:fixed;left:0;right:0;bottom:0;height:var(--footer-h);
      background:#fff;border-top:none;display:flex;align-items:center;
      justify-content:flex-start;padding-left:5px;font-size:12px;color:#666;z-index:1000;
    }

    /* 반응형: 모바일에서 메뉴 줄바꿈 */
    @media (max-width: 700px){
      .menu-list{flex-wrap:wrap;row-gap:6px;height:auto;padding:6px 12px;}
      .menu-item{height:38px;padding-bottom:6px;}
    }
  </style>
</head>
<body>
  <!-- 상단 두 줄 -->
  <header class="top-title" role="banner">
    <div class="title-txt">VURIX Mobile</div>
  </header>
  <nav class="top-menu" role="navigation" aria-label="주 메뉴">
    <div class="menu-list" id="menuList">
      <button class="menu-item" data-src="./start.html">시작</button>
      <button class="menu-item" data-src="./live.html">실시간 영상</button>
      <button class="menu-item" data-src="./recorded.html">녹화 영상</button>
      <button class="menu-item" data-src="./event.html">이벤트</button>
      <button class="menu-item" data-src="./setup.html">설정</button>
      <button class="menu-item" data-src="./other.html">기타</button>
      <button class="menu-item" data-src="./info.html">참고</button>
    </div>
  </nav>

  <!-- 중앙 콘텐츠 -->
  <main class="content-wrap" role="main">
    <div class="content-inner">
      <iframe id="contentFrame" title="콘텐츠 프레임" src="" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
  </main>

  <!-- 하단바 -->
  <footer class="footer" role="contentinfo">©2025 Innodep, Inc.</footer>

  <script>
    (function(){
      var iframe = document.getElementById('contentFrame');
      var menuButtons = Array.prototype.slice.call(document.querySelectorAll('.menu-item'));
      var menuList = document.getElementById('menuList');
      var topMenu = document.querySelector('.top-menu');

      function setActive(btn){
        menuButtons.forEach(function(b){ b.classList.toggle('active', b===btn); });
      }

      function loadSrc(src, btn){
        if (!src) return;
        iframe.src = src;
        if (btn) setActive(btn);
        // 해시 갱신
        try {
          if (location.hash !== '#' + src) location.hash = '#' + src;
        } catch(e){}
      }

      // 실제 메뉴 높이로 콘텐츠 시작점 보정
      function applyHeaderHeight(){
        try{
          var h = topMenu.getBoundingClientRect().height;
          document.documentElement.style.setProperty('--header2-computed', h + 'px');
        }catch(e){}
      }

      // 모바일/PC 클래스 토글 및 스크롤 정책
      function applyViewportMode(){
        var isMobile = window.innerWidth <= 700;
        // PC에서 이중 스크롤 방지: 바깥 숨김, iframe만 세로 스크롤
        document.documentElement.style.overflowY = isMobile ? 'auto' : 'hidden';
        document.body.style.overflowY = isMobile ? 'auto' : 'hidden';
        applyHeaderHeight();
      }

      // 내부 문서 주입: 폰트 매핑(rem) + 표 규칙 + 제목 여백 제거
      function injectStyles(doc){
        if (!doc) return;
        try{
          var head = doc.head || doc.getElementsByTagName('head')[0];
          if (!head) return;

          // 공통: 마진 접힘 방지 + 첫 대제목 여백 제거 + 아이콘 1em
          var base = document.createElement('style');
          base.type = 'text/css';
          base.appendChild(document.createTextNode(
            'html, body{margin:0;padding:0;}' +
            'body{display:flow-root;}' +
            'body>*:first-child{margin-top:0 !important;}' +
            '._1-1-Heading:first-of-type{margin-top:0 !important;padding-top:0 !important;}' +
            'img[src*="0_ICON"]{height:1em;width:auto;vertical-align:middle;}'
          ));
          head.appendChild(base);

          // PC 전용 폰트 매핑 (rem + line-height)
          var pcCss = [
            '[class~="01-1-Heading"], [class~="01-1-Heading"] * { font-size:3.125rem !important; line-height:1.25 !important; }',
            '[class~="01-2-Heading"], [class~="01-2-Heading"] * { font-size:2.8125rem !important; line-height:1.3 !important; }',
            '[class~="01-3-Heading"], [class~="01-3-Heading"] * { font-size:2.5rem !important; line-height:1.3 !important; }',
            /* 본문·리스트·볼드 등 */
            '[class*="02-"], [class*="03-"], [class*="04-"], [class*="05-"], [class*="06-"], [class*="07-"] { font-size:2.1875rem !important; line-height:1.6 !important; }',
            '[class*="02-"] *, [class*="03-"] *, [class*="04-"] *, [class*="05-"] *, [class*="06-"] *, [class*="07-"] * { font-size:inherit !important; line-height:inherit !important; }',
            /* Small 계열 */
            '[class*="08-"]{ font-size:2.0625rem !important; line-height:1.7 !important; }',
            '[class*="08-"] *{ font-size:inherit !important; line-height:inherit !important; }',
            /* 가운데 정렬 변형 보존 */
            '[class~="02-3-Basic-L-Center"], [class~="05-3-Bold-Center"], [class~="08-3-Small-L-Center"], [class~="08-4-Small-B-Center"]{ text-align:center !important; }',
            /* 글자 축소 방지: 최소 폭 */
            'html, body{ min-width:900px; }'
          ].join('\n');

          // 모바일(<=700px) 전용: 더 작게 + 테이블 줄바꿈
          var moCss = [
            /* Heading */
            '[class~="01-1-Heading"], [class~="01-1-Heading"] * { font-size:1.75rem !important; line-height:1.3 !important; }',
            '[class~="01-2-Heading"], [class~="01-2-Heading"] * { font-size:1.5rem !important; line-height:1.3 !important; }',
            '[class~="01-3-Heading"], [class~="01-3-Heading"] * { font-size:1.25rem !important; line-height:1.35 !important; }',
            /* 본문 */
            '[class*="02-"], [class*="03-"], [class*="04-"], [class*="05-"], [class*="06-"], [class*="07-"] { font-size:1.125rem !important; line-height:1.7 !important; }',
            '[class*="02-"] *, [class*="03-"] *, [class*="04-"] *, [class*="05-"] *, [class*="06-"] *, [class*="07-"] * { font-size:inherit !important; line-height:inherit !important; }',
            /* Small */
            '[class*="08-"]{ font-size:1rem !important; line-height:1.75 !important; }',
            '[class*="08-"] *{ font-size:inherit !important; line-height:inherit !important; }',
            /* 테이블 */
            'table{ width:100% !important; table-layout:auto !important; }',
            'th,td{ white-space:normal !important; overflow-wrap:anywhere !important; word-break:break-word !important; }',
            'table img{ max-width:100% !important; height:auto !important; }'
          ].join('\n');

          var stylePc = document.createElement('style');
          stylePc.type = 'text/css';
          stylePc.media = 'screen and (min-width: 701px)';
          stylePc.appendChild(document.createTextNode(pcCss));
          head.appendChild(stylePc);

          var styleMo = document.createElement('style');
          styleMo.type = 'text/css';
          styleMo.media = 'screen and (max-width: 700px)';
          styleMo.appendChild(document.createTextNode(moCss));
          head.appendChild(styleMo);
        }catch(e){}
      }

      function onIframeLoad(){
        try{
          var doc = iframe.contentDocument || iframe.contentWindow.document;
          injectStyles(doc);
        }catch(e){}
      }

      iframe.addEventListener('load', onIframeLoad);

      // 해시 → 메뉴/iframe 동기화
      function syncFromHash(){
        var hash = location.hash || '#start.html';
        var src = hash.replace(/^#/, '');
        var targetBtn = null;
        for (var i=0;i<menuButtons.length;i++){
          if (menuButtons[i].dataset.src === src){ targetBtn = menuButtons[i]; break; }
        }
        if (targetBtn){ setActive(targetBtn); }
        iframe.src = src;
      }
      window.addEventListener('hashchange', syncFromHash);

      // 메뉴 클릭
      menuButtons.forEach(function(btn){
        btn.addEventListener('click', function(){ loadSrc(btn.dataset.src, btn); });
      });

      // 초기 적용
      document.addEventListener('DOMContentLoaded', function(){
        applyViewportMode();
        syncFromHash();
      });
      window.addEventListener('resize', applyViewportMode);
      // 메뉴 높이 변화를 실시간 반영
      if ('ResizeObserver' in window){
        var ro = new ResizeObserver(function(){ applyHeaderHeight(); });
        ro.observe(menuList);
      }
    })();
  </script>
</body>
</html>
