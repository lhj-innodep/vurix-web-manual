<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>VURIX Mobile 웹 매뉴얼</title>
  <style>
    :root{
      --header1-h:56px;           /* 타이틀 바 높이 */
      --header2-h:56px;           /* 메뉴 바 기준 높이 */
      --header2-computed:56px;    /* 실제 측정된 메뉴 높이 (JS 갱신) */
      --footer-h:40px;            /* 푸터 높이 */
      --bar-bg:#f6f6f6;
      --gh-border:#d0d7de;
      --gh-active:#0969da;
      --scale:1.5;                /* PC 확대 배율 */
      --fixed-width:900px;        /* 고정 컨텐츠 폭 */
      --bp-mobile:730px;          /* 모바일 임계폭 */
      --gap-cf:14px;              /* 콘텐츠-푸터 사이 여백(요청 반영) */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:#fff;color:#222;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Malgun Gothic","맑은 고딕",Arial,sans-serif}

    /* PC에선 바깥 스크롤을 막고 iframe만 스크롤 */
    @media (min-width: 1024px){
      html, body { overflow: hidden; }
    }

    /* 상단 타이틀 */
    .top-title{
      position:fixed;top:0;left:0;right:0;height:var(--header1-h);
      background:var(--bar-bg);display:flex;align-items:center;
      z-index:1000;border-bottom:none;
    }
    .title-inner{
      width:var(--fixed-width);max-width:100%;
      margin:0; padding:0 16px; /* 좌측 정렬 */
      display:flex;align-items:center;gap:12px;
    }
    .title-text{font-size:18px;font-weight:700;color:#111;white-space:nowrap;}

    /* 상단 메뉴 (GitHub 스타일 탭 + 좌측 정렬) */
    .top-menu{
      position:fixed;top:var(--header1-h);left:0;right:0;
      background:var(--bar-bg);z-index:999;border-bottom:1px solid var(--gh-border);
      overflow:hidden; /* 스크롤바 차단 */
    }
    .menu-inner{
      width:var(--fixed-width);max-width:100%;
      margin:0; padding:0 12px;
      height:auto;
    }
    .menu-list{display:flex;align-items:flex-end;gap:16px;flex-wrap:nowrap;justify-content:flex-start;min-height:var(--header2-h);}
    .menu-item{
      position:relative;background:transparent;border:0;cursor:pointer;
      padding:10px 10px 12px 10px;display:flex;align-items:end;
      font-size:15px;color:#24292f;border-radius:0;white-space:nowrap;
    }
    .menu-item:hover{color:#111;}
    .menu-item.active{color:#111;font-weight:600;}
    .menu-item.active::after{
      content:"";position:absolute;left:6px;right:6px;bottom:-1px;height:2px;background:var(--gh-active);
    }

    /* 콘텐츠 영역: 상단은 실제 측정 높이, 하단은 푸터 + 추가 여백 */
    .content-wrap{
      position:fixed;left:0;right:0;
      top:calc(var(--header1-h) + var(--header2-computed));
      bottom:calc(var(--footer-h) + var(--gap-cf)); /* ← 요청: 푸터와의 여백 */
      display:block;background:#fff;
    }
    .content-inner{
      width:var(--fixed-width);max-width:100%;height:100%;
      margin:0; padding-left:20px; /* 좌측 여백 20px 유지 */
    }
    iframe#contentFrame{
      width:100%;height:100%;border:none;background:#fff;display:block;
    }

    /* 하단바 */
    .footer{
      position:fixed;left:0;right:0;bottom:0;height:var(--footer-h);
      background:#fff;border-top:none;z-index:1000;display:flex;align-items:center;justify-content:center;
    }
    .footer-inner{
      width:var(--fixed-width);max-width:100%;
      margin:0; padding:0 20px;
      text-align:center; font-size:12px;color:#666;
    }

    /* 모바일(≤730px): 메뉴 줄바꿈, 페이지 스크롤 허용 */
    @media (max-width: 730px){
      :root{ --header1-h:52px; }
      html, body { overflow: auto; }
      .menu-list{ flex-wrap:wrap; row-gap:6px; }
      .menu-item{ font-size:14px; padding:8px 8px 10px 8px; }
    }
  </style>
</head>
<body>
  <!-- 상단 고정바 -->
  <header class="top-title" role="banner">
    <div class="title-inner">
      <span class="title-text">VURIX Mobile</span>
    </div>
  </header>
  <nav class="top-menu" role="navigation" aria-label="주 메뉴">
    <div class="menu-inner">
      <div class="menu-list" id="menuList">
        <button class="menu-item" data-src="./start.html">시작</button>
        <button class="menu-item" data-src="./live.html">실시간 영상</button>
        <button class="menu-item" data-src="./recorded.html">녹화 영상</button>
        <button class="menu-item" data-src="./event.html">이벤트</button>
        <button class="menu-item" data-src="./setup.html">설정</button>
        <button class="menu-item" data-src="./other.html">기타</button>
        <button class="menu-item" data-src="./info.html">참고</button>
      </div>
    </div>
  </nav>

  <!-- 중앙 콘텐츠 -->
  <main class="content-wrap" role="main">
    <div class="content-inner">
      <iframe id="contentFrame" title="콘텐츠 프레임" src="" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
  </main>

  <!-- 하단바 -->
  <footer class="footer" role="contentinfo">
    <div class="footer-inner">©2025 Innodep, Inc.</div>
  </footer>

  <script>
    (function(){
      const iframe = document.getElementById('contentFrame');
      const menuButtons = Array.from(document.querySelectorAll('.menu-item'));
      const menuList = document.getElementById('menuList');
      const topMenu = document.querySelector('.top-menu');

      /* 메뉴 클릭 시 iframe 로드 + 해시 갱신 */
      function setActive(btn){ menuButtons.forEach(b=>b.classList.toggle('active', b===btn)); }
      function loadSrc(src, btn){
        iframe.src = src;
        if(btn) setActive(btn);
        // 해시 갱신
        try { if (src) history.replaceState(null, '', '#' + src.replace('./','')); } catch(e){}
      }

      // 실제 메뉴 높이를 측정해 변수 갱신
      function updateHeaderHeight(){
        const rect = topMenu.getBoundingClientRect();
        const h = Math.ceil(rect.height);
        document.documentElement.style.setProperty('--header2-computed', h + 'px');
      }

      // 초기 진입: 해시가 있으면 해당 페이지, 없으면 start.html
      document.addEventListener('DOMContentLoaded', ()=>{
        const initial = (location.hash && location.hash.slice(1)) || 'start.html';
        const btn = menuButtons.find(b => b.dataset.src.endsWith(initial)) || menuButtons[0];
        loadSrc(btn ? btn.dataset.src : './start.html', btn);
        updateHeaderHeight();
      });

      // 메뉴 이벤트
      menuButtons.forEach(btn => btn.addEventListener('click', ()=> loadSrc(btn.dataset.src, btn)));

      // 리사이즈 시 메뉴 높이 재측정
      window.addEventListener('resize', updateHeaderHeight);
      new ResizeObserver(updateHeaderHeight).observe(menuList);

      // iframe 로드 후 내부 문서 강화(확대/아이콘/표/첫제목 여백 등)
      function onIframeLoad(){
        try{
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          if(!doc) return;

          // PC에서만 내부 확대
          const isDesktop = window.matchMedia('(min-width: 1024px)').matches;
          if (isDesktop){
            // 확대: 우선 zoom, 폴백 transform
            doc.body.style.zoom = (getComputedStyle(document.documentElement).getPropertyValue('--scale') || '1.5').trim();
            if (!doc.body.style.zoom){
              doc.body.style.transform = 'scale(1.5)';
              doc.body.style.transformOrigin = 'top left';
              doc.body.style.width = 'calc(100% / 1.5)';
            }
            // 내부 최소 폭 보장(원본 기준 900px)
            const styleMin = doc.createElement('style');
            styleMin.textContent = `html, body { min-width: 900px !important; }`;
            doc.head && doc.head.appendChild(styleMin);
          }

          // 첫 대제목 위 여백 제거 + 마진 접힘 방지
          const styleHeading = doc.createElement('style');
          styleHeading.textContent = `
            body { display: flow-root !important; }
            body > *:first-child { margin-top: 0 !important; }
            ._1-1-Heading:first-of-type, [class*="1-1-Heading"]:first-of-type, h1:first-of-type {
              margin-top: 0 !important; padding-top: 0 !important;
            }
          `;
          doc.head && doc.head.appendChild(styleHeading);

          // 아이콘 자동 리사이즈
          doc.querySelectorAll('img[src*="0_ICON"]').forEach(img => {
            img.style.height = '1em'; img.style.width = 'auto'; img.style.verticalAlign = 'middle';
          });

          // 모바일 전용: 표 강제맞춤(A안) - 임계폭 730px
          const isMobile = window.matchMedia('(max-width: 730px)').matches;
          if (isMobile){
            const styleTable = doc.createElement('style');
            styleTable.textContent = `
              @media (max-width: 730px){
                table { width: 100% !important; table-layout: fixed !important; }
                th, td { white-space: nowrap; text-overflow: ellipsis; overflow: hidden; padding: 6px; }
                table img { max-width: 100% !important; height: auto !important; }
              }
            `;
            doc.head && doc.head.appendChild(styleTable);
          }
        }catch(e){}
      }
      iframe.addEventListener('load', onIframeLoad);
    })();
  </script>
</body>
</html>
